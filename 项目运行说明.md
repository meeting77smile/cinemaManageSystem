# 影院管理系统 - 项目运行说明

## 问题解决

您遇到的CORS错误已经修复。主要修改了以下内容：

### 1. CORS配置修复
- 修改了 `WebMvcConfig.java` 中的CORS配置
- 使用 `allowedOriginPatterns("*")` 替代 `allowedOrigins()`
- 这样可以支持file://协议直接打开HTML文件

## 正确的项目运行方式

### 方式一：通过Spring Boot运行（推荐）

1. **启动后端服务**
   ```bash
   # 在项目根目录执行
   mvn spring-boot:run
   
   # 或者使用IDE运行 CinemaManageSystemApplication.java
   ```

2. **访问前端页面**
   - 启动成功后，访问：http://localhost:8080/login.html
   - 这样可以避免CORS问题，因为前后端在同一域名下

### 方式二：直接打开HTML文件（已修复CORS）

1. **启动后端服务**
   ```bash
   mvn spring-boot:run
   ```

2. **直接打开HTML文件**
   - 双击 `src/main/resources/static/login.html`
   - 或者在浏览器中打开该文件
   - 现在CORS配置已修复，应该可以正常访问后端API

## 测试账号

### 管理员账号
- 用户名：admin
- 密码：123456
- 登录后会跳转到管理员界面

### 普通用户账号
- 用户名：user1
- 密码：123456
- 登录后会跳转到用户界面

## 数据库配置

确保MySQL数据库已启动，并且：
1. 数据库名：cinema_system
2. 用户名和密码在 `application.yml` 中配置
3. 执行 `cinema_system.sql` 创建表和初始数据

## 功能验证

### 登录功能
1. 打开登录页面
2. 输入测试账号
3. 点击登录
4. 根据角色跳转到对应页面

### 管理员功能
- 仪表盘：查看统计数据
- 影院管理：查看、删除影院
- 电影管理：查看、删除电影
- 场次管理：查看、删除场次（时间状态显示已修复）
- 用户管理：查看、禁用/启用用户
- 订单管理：查看订单列表

### 用户功能
- 浏览电影
- 查看影院
- 购票选座
- 查看个人订单

## 常见问题

### 1. CORS错误
- 已修复，现在支持file://协议
- 推荐使用方式一通过Spring Boot访问

### 2. 403 Forbidden
- 检查Spring Boot是否正常启动
- 检查端口8080是否被占用
- 查看控制台日志

### 3. 数据库连接错误
- 检查MySQL是否启动
- 检查application.yml中的数据库配置
- 确保数据库和表已创建

### 4. 场次状态显示问题
- 已修复时间判断逻辑
- 现在会正确显示：未开始/进行中/已结束

## 开发工具推荐

### 后端开发
- IDE：IntelliJ IDEA 或 Eclipse
- 数据库：MySQL Workbench 或 Navicat

### 前端调试
- 浏览器：Chrome（推荐）
- 开发者工具：F12查看网络请求和控制台日志

### API测试
- 访问：http://localhost:8080/doc.html
- 使用Knife4j进行API测试

## 项目结构

```
CinemaManageSystem/
├── src/main/java/com/cinema/
│   ├── controller/     # 控制器层
│   ├── service/        # 服务层
│   ├── mapper/         # 数据访问层
│   ├── entity/         # 实体类
│   ├── config/         # 配置类
│   ├── common/         # 公共类
│   └── util/           # 工具类
├── src/main/resources/
│   ├── static/         # 静态资源（HTML、CSS、JS）
│   ├── application.yml # 应用配置
│   └── cinema_system.sql # 数据库脚本
└── pom.xml            # Maven配置
```

现在您可以重新启动Spring Boot应用，然后尝试登录功能，CORS问题应该已经解决了。
